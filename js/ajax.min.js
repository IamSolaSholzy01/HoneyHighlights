var isLoggedIn,subscribe=function(){var subForm=$(".subscribe-form");subForm.submit((function(e){return url=subForm.attr("action"),type=subForm.attr("method"),data={},subForm.find("[name]").each((function(){var that=$(this),name=that.attr("name"),value=that.val();data[name]=value})),$.ajax({type:type,url:url,dataType:"JSON",data:data,success:function(response){$("#subscribe-form").css("display","none"),$("#subscribe-result").html(response.content),$("#subscribe-result").css("display","block")},error:function(response){$("#subscribe-result").html(response.email)}}),!1}))},register=function(){var regForm=$(".registrationform");regForm.submit((function(e){return url=regForm.attr("action"),type=regForm.attr("method"),data={},regForm.find("[name]").each((function(){var that=$(this),name=that.attr("name"),value=that.val();data[name]=value})),$.ajax({type:type,url:url,dataType:"JSON",data:data,success:function(response){"duplicateName"==response.id?(shakeModal(),$("#response").html(response.content),$(".error").addClass("alert alert-danger"),setTimeout(()=>{$("#username").val(""),$("#regpassword").val(""),$("passwordconfirmation").val("")},3e3)):"duplicateEmail"==response.id?(shakeModal(),$("#response").html(response.content),$("#response").css("color","red"),$(".error").addClass("alert alert-danger"),setTimeout(()=>{$("#username").val(""),$("#regemail").val(""),$("#regpassword").val(""),$("#firstname").val(""),$("#surname").val(""),$("#passwordconfirmation").val(""),$("#response").val("")},3e3)):"success"==response.id&&($("#response").html(response.content),$("#response").css("color","green"),$(".error").addClass("alert alert-success"),setTimeout(()=>{$("#regemail").val(""),$("#regpassword").val(""),$("#firstname").val(""),$("#surname").val(""),$("#passwordconfirmation").val(""),$("#response").val(""),$(".error").removeClass("alert alert-success"),showLoginForm()},3e3)),$("input:submit").removeAttr("disabled")},error:function(){$("#response").text("Serious error"),shakeModal(),$("input:submit").removeAttr("disabled")}}),!1}))},login=function(){var logForm=$(".logform");logForm.submit((function(e){return url=logForm.attr("action"),type=logForm.attr("method"),data={},logForm.find("[name]").each((function(){var that=$(this),name=that.attr("name"),value=that.val();data[name]=value})),$.ajax({type:type,url:url,dataType:"JSON",data:data,success:function(response){"error"==response.id?($("#reply").html(response.content),$("#reply").css("color","red"),$(".error").addClass("alert alert-danger"),shakeModal(),setTimeout(()=>{$("#loginemail").val(""),$("#loginpassword").val("")},3e3)):"emailerror"==response.id?($("#reply").html(response.content),$("#reply").css("color","red"),$(".error").addClass("alert alert-danger"),shakeModal(),setTimeout(()=>{$("#loginemail").val(""),$("#loginpassword").val("")},3e3)):response&&(sessionStorage.setItem("id",response.id),sessionStorage.setItem("username",response.username),sessionStorage.setItem("email",response.email),sessionStorage.setItem("firstname",response.firstname),$("#reply").html("Login Successful"),$("#reply").css("color","green"),$(".error").removeClass("alert alert-danger"),$(".error").addClass("alert alert-success"),$("#loginLink").css("display","none"),$("#logoutLink").css("display","block"),setTimeout(()=>{$("#loginemail").val(""),$("#loginpassword").val(""),$("#reply").text(""),$(".error").removeClass("alert alert-success"),$("#loginLink").css("display","none"),$("#logoutLink").css("display","block"),closeModal()},3e3)),$("input:submit").removeAttr("disabled")},error:function(response){$("#reply").text("Serious error"),$(".error").addClass("alert alert-danger"),shakeModal(),$("input:submit").removeAttr("disabled")}}),!1}))};function signOut(){var auth2;gapi.auth2.getAuthInstance().signOut().then((function(){}))}function onLoad(){gapi.load("auth2",(function(){gapi.auth2.init()}))}function onSignIn(googleUser){var url=document.getElementById("google").value,profile=googleUser.getBasicProfile();sessionStorage.setItem("id",profile.getId()),sessionStorage.setItem("username",profile.getName()),sessionStorage.setItem("email",profile.getEmail()),$.ajax({type:"POST",url:url,dataType:"JSON",data:{username:profile.getName(),email:profile.getEmail(),id:profile.getId()},success:function(response){"success"==response.feedback&&($("#reply").html("Login Successful"),$("#reply").css("color","green"),$(".error").removeClass("alert alert-danger"),$(".error").addClass("alert alert-success"),$("#loginLink").css("display","none"),$("#logoutLink").css("display","block"),setTimeout(()=>{$("#loginemail").val(""),$("#loginpassword").val(""),$("#reply").text(""),$(".error").removeClass("alert alert-success"),$("#loginLink").css("display","none"),$("#logoutLink").css("display","block"),closeModal()},3e3))},error:function(){}})}var setAsLoggedIn=function(){isLoggedIn=!0},setAsLoggedOut=function(){isLoggedIn=!1,sessionStorage.clear()},toggleLoginLogout=function(){var login=document.getElementById("loginLink"),logout=document.getElementById("logoutLink");login.style.display="none",logout.style.display="block"},logout=function(){null!=sessionStorage.getItem("email")?toggleLoginLogout():null==sessionStorage.getItem("email")&&($("#loginLink").css("display","block"),$("#logoutLink").css("display","none"))},postComment=function(){var commentForm=$("#ajax-form");commentForm.submit((function(e){return url=commentForm.attr("action"),type=commentForm.attr("method"),data={},commentForm.find("[name]").each((function(){var that=$(this),name=that.attr("name"),value=that.val();data[name]=value})),$.ajax({type:type,url:url,dataType:"JSON",data:data,success:function(response){"success"==response.feedback&&($(".response").text("Your comment has been sent"),$(".response").css("color","green"),$(".response").addClass("alert alert-success"),setTimeout(()=>{$("#name").val(""),$("#email").val(""),$("#message").val(""),$(".response").text(""),$(".response").removeClass("alert alert-success"),runn()},3e3)),$("input:submit").removeAttr("disabled")},error:function(){$(".response").text("Big error"),$(".response").addClass("alert alert-danger"),$("input:submit").removeAttr("disabled")}}),!1}))},runn=function(){url="../php/load-comments.php",type="POST";var value=$("#post_id").val();return $.ajax({type:type,url:url,dataType:"JSON",data:{post_id:value},success:function(response){if("error"==response.id)$(".commentnum").html("0"),$("#empty").html(response.content);else{$("#empty").html("");var num=0;$.each(response,(function(){num++;var newComment=$("body").find("#honey-comments > li").clone();newComment.find(".honey-comment-name").append(this.name),newComment.find(".honey-comment-body").append(this.body),newComment.find(".honey-reply-icon").addClass(this.comment_id),newComment.find(".honey-reply-icon").attr("id",this.comment_id),$(newComment).appendTo("#honey-comments-list")})),$(".commentnum").html(num),$("input:submit").removeAttr("disabled")}},error:function(response){$(".response").text("Big error"),$(".response").addClass("alert alert-danger"),$("input:submit").removeAttr("disabled")}}),!1},loadData=function(){var value=$("#post_id").val();return url="../php/load-data.php",type="POST",$.ajax({type:type,url:url,dataType:"JSON",data:{post_id:value},success:function(response){$("#post_author").html(response.author),$("#post_date").html(response.created_at)},error:function(response){$("input:submit").removeAttr("disabled")}}),!1},runner=function(){url="../php/load-reply.php",type="POST";var postid=document.getElementById("post_id").value;$.ajax({type:type,url:url,dataType:"JSON",data:{post_id:postid},success:function(response){"error"==response.id?$(".honey-reply-body").html(""):$.each(response,(function(){var row=this,c_id=this.comment_id;$("#honey-comments-list").find(".honey-reply-icon").each((function(){var div_id=$(this).attr("id");if(c_id===div_id){var newComment=$("body").find("#honey-comments .honey-reply-box").clone();newComment.find(".honey-reply-name").append(row.name),newComment.find(".honey-reply-body").append(row.body),$("#"+div_id).closest(".honey-comment-box").find("#reply-div").css("display","block"),$(newComment).appendTo($("#"+div_id).closest(".honey-comment-box").find("#reply-div"))}}))}))},error:function(){$(".response").text("Big error"),$(".response").addClass("alert alert-danger"),$("input:submit").removeAttr("disabled")}})},postreply=function(){var id=document.getElementById("hidden-id").value,postid=document.getElementById("post_id").value;$("#"+id).closest(".honey-comment-box").find("#reply-div").slideToggle();var text_value=$("#"+id).closest(".honey-comment-box").find(".reply-input").val();return url="../php/postreply.php",type="POST",$.ajax({type:type,url:url,dataType:"JSON",data:{post_id:postid,comment_id:id,text:text_value},success:function(response){$("#"+id).closest(".honey-comment-box").find(".reply-input").val(""),"1"==response.id?(alert("Please LOG IN to Reply"),openLoginModal()):"success"==response.feedback&&runner(),$("input:submit").removeAttr("disabled")},error:function(response){response.id,alert("Please LOG IN to Reply"),openLoginModal(),$("input:submit").removeAttr("disabled")}}),!1},replyclicked=function(id){document.getElementById("hidden-id").value=id,$("#"+id).closest(".honey-comment-box").find("#reply-input").slideToggle()},showreply=function(me){$(me).closest(".honey-comment-box").find("#reply-div").slideToggle()},reaction=function(me){var id=me.id,postid=document.getElementById("post_id").value;url="../php/reaction.php",type="POST",$.ajax({type:type,url:url,dataType:"JSON",data:{post_id:postid,reaction:id},success:function(response){"success"==response.id&&"like"==id?($("#thumbup").html(response.likes),$("#like").css("color","blue"),$("#thumbdown").html(response.dislikes)):"success"==response.id&&"dislike"==id&&($("#thumbup").html(response.likes),$("#dislike").css("color","red"),$("#thumbdown").html(response.dislikes)),$("input:submit").removeAttr("disabled")},error:function(response){$("input:submit").removeAttr("disabled")}}),"like"==me.id||me.id},loadreaction=function(){var postid=document.getElementById("post_id").value;url="../php/load-reaction.php",type="POST",$.ajax({type:type,url:url,dataType:"JSON",data:{post_id:postid},success:function(response){"success"==response.id&&($("#thumbup").html(response.likes),$("#thumbdown").html(response.dislikes)),$("input:submit").removeAttr("disabled")},error:function(response){$("input:submit").removeAttr("disabled")}})};